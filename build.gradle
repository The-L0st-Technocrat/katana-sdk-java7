group 'katana'
version '1.0-SNAPSHOT'

apply plugin: 'application'
apply plugin: "jacoco"

mainClassName = "com.katana.example.middlewares.JsonMiddlewareSample"

applicationDefaultJvmArgs = ["-Djava.library.path=/usr/local/lib"]

run {
    if(System.getProperty("exec.args") != null) {
        args System.getProperty("exec.args").split()
    }
}

sourceCompatibility = 1.8

repositories {
    mavenCentral()
}

dependencies {
    compile 'org.zeromq:jeromq:0.3.5'
    compile 'org.msgpack:msgpack-core:0.8.10'
    compile 'org.msgpack:jackson-dataformat-msgpack:0.8.10'

    testCompile group: 'junit', name: 'junit', version: '4.12'
    testCompile 'org.mockito:mockito-core:1.+'
    testCompile group: 'uk.co.jemos.podam', name: 'podam', version: '7.0.0.RELEASE'
}

jar {
    manifest {
        attributes(
                'Main-Class': 'com.katana.example.middlewares.JsonMiddlewareSample'
        )
    }
    from {
        configurations.compile.collect {
            it.isDirectory() ? it : zipTree(it)
        }
    }
}

jacocoTestReport {
    reports {
        xml.enabled true
        csv.enabled false
        html.destination "${buildDir}/jacocoHtml"
    }
}

